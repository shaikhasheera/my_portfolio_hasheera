try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="fab6a0eb-fc4d-4087-9bda-f7e29ecff377",e._sentryDebugIdIdentifier="sentry-dbid-fab6a0eb-fc4d-4087-9bda-f7e29ecff377")}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9144],{565:(e,t,r)=>{"use strict";r.d(t,{i:()=>a});let l=null,a=()=>l?Promise.resolve(l):new Promise(e=>{if(!window.collectEvent){e("");return}try{window.collectEvent("getToken",t=>{t&&t.ssid?(l=t.ssid,e(t.ssid)):e("")})}catch(t){e("")}})},23468:(e,t,r)=>{Promise.resolve().then(r.bind(r,78335)),Promise.resolve().then(r.bind(r,59710))},47835:(e,t,r)=>{"use strict";r.d(t,{a:()=>a});var l=r(34477);let a=(0,l.createServerReference)("609f96f93197757e98f3ef53379cb0fd45a3f2d999",l.callServer,void 0,l.findSourceMapURL,"verifyPasscode")},59710:(e,t,r)=>{"use strict";r.d(t,{default:()=>o});var l=r(95155),a=r(6874),n=r.n(a);r(12115);var s=r(99113);function o(e){let{error:t="Something went wrong!",reset:r}=e;return(0,l.jsxs)("div",{className:"flex min-h-screen flex-col",children:[(0,l.jsx)(s.default,{hideRight:!0}),(0,l.jsxs)("main",{className:"mb-20 flex w-full flex-1 flex-col items-center justify-center px-6 sm:px-4",children:[(0,l.jsx)("h2",{className:"text-center text-[28px]/8 sm:text-[32px]/9 md:text-[40px]/10",children:t}),(0,l.jsx)("p",{className:"mt-3 text-center text-sm text-black/45 sm:text-base",children:"Please try again later or contact support if the problem persists."}),(0,l.jsxs)("div",{className:"mt-12 flex gap-4 sm:mt-16 md:mt-20",children:[(0,l.jsx)("button",{onClick:()=>{r?r():window.location.reload()},className:"shine-effect flex h-12 w-36 cursor-pointer items-center justify-center rounded-full bg-black/95 text-sm text-white sm:h-14 sm:w-40 sm:text-base",children:"Try Again"}),(0,l.jsx)(n(),{href:"https://www.youware.com",className:"shine-effect flex h-12 w-36 cursor-pointer items-center justify-center rounded-full border border-black/95 text-sm text-black/95 sm:h-14 sm:w-40 sm:text-base",children:"Go Home"})]})]})]})}},61884:(e,t,r)=>{"use strict";function l(e){return e>1e3&&e<1e6?(e/1e3).toFixed(1)+"K":e>1e6?(e/1e6).toFixed(1)+"M":e>1e9?(e/1e9).toFixed(1)+"B":e}r.d(t,{Z:()=>l})},78335:(e,t,r)=>{"use strict";r.d(t,{default:()=>ek});var l=r(95155),a=r(25427),n=r(35695),s=r(12115),o=r(34477);let c=(0,o.createServerReference)("00d71391d50ce27f03455e2defa45bbe120e1b641a",o.callServer,void 0,o.findSourceMapURL,"syncClientIdToCookie"),i=(0,o.createServerReference)("40ef256009b0db72736ebf120dc0ee454c5d5d9eb5",o.callServer,void 0,o.findSourceMapURL,"getComments"),d=(0,o.createServerReference)("78c5e629d912d70fed32c3bdeeb5f5ba6f9d082416",o.callServer,void 0,o.findSourceMapURL,"reportStatsProjectIncr"),u=(0,o.createServerReference)("40a9f7c9d3c0b1b945836e6893d81fdc8a1469fc19",o.callServer,void 0,o.findSourceMapURL,"viewProject"),p=()=>{let[e,t]=(0,s.useState)(!1),[r,l]=(0,s.useState)(void 0),a=(0,s.useCallback)(()=>{t(!0)},[]),n=(0,s.useCallback)(()=>{t(!1),l(void 0)},[]);return{isOpen:e,highlightedCommentId:r,openPanel:a,closePanel:n,togglePanel:(0,s.useCallback)(()=>{t(e=>!e)},[]),setHighlightedComment:(0,s.useCallback)(e=>{l(e),e&&t(!0)},[]),setIsOpen:t,commentPanelProps:{isOpen:e,onClose:n,anchorCommentId:r}}};var m=r(80246);let x=(0,o.createServerReference)("4037e9359e23e076c01b13490264781ecb81aedda8",o.callServer,void 0,o.findSourceMapURL,"getReportReasonsAction"),f=(0,o.createServerReference)("40aa21cf61c520239e7a40ce3834dc538e8fe36dd5",o.callServer,void 0,o.findSourceMapURL,"postReportAction");var h=r(56389),v=r(48436),b=r(26846);let j={project:"Why are you reporting this project?"},g=e=>{let{contentId:t,subjectType:r,onClose:n,trackExtra:o}=e,[c,i]=(0,s.useState)([]),[d,u]=(0,s.useState)(null),[p,m]=(0,s.useState)(""),[g,w]=(0,s.useState)(!1),[_,y]=(0,s.useState)(!0),{track:k}=(0,h.s)();(0,s.useEffect)(()=>{(async()=>{y(!0);let e=await x({entity_type:r});0===e.code&&e.data?i(e.data.reasons):(0,v.P)({message:"Get report reasons failed, please try again later",type:"error"}),y(!1)})()},[]);let N=async e=>{let{reason:l,details:a}=e;k("report_submit_click",{...o,report_reason:(null==d?void 0:d.reason)==="other"?p:l}),w(!0);let s=await f({entity_type:r,entity_id:t,reason:l,details:a});w(!1),0===s.code&&s.data?(n(),(0,v.P)({message:"Thanks for reporting. We’ll review this as soon as possible.",type:"success"})):(0,v.P)({message:"Report failed, please try again later",type:"error"})},S=!_&&!g&&d;return(0,l.jsx)("div",{className:"fixed inset-0 z-50 flex h-full w-full items-center justify-center bg-black/20",onClick:e=>{!g&&e.target===e.currentTarget&&n()},children:(0,l.jsxs)("div",{className:"flex w-[512px] max-w-[calc(100vw-32px)] flex-col gap-3 rounded-[16px] bg-white p-6 shadow-[0px_0px_2px_0px_rgba(0,0,0,0.10),0px_16px_32px_-1px_rgba(12,12,13,0.1)]",children:[(0,l.jsx)("h3",{className:"text-[20px] font-bold",children:j[r]}),(0,l.jsx)("div",{className:"flex w-full flex-col gap-1",children:_?(0,l.jsx)(l.Fragment,{children:[void 0,void 0,void 0,void 0].map((e,t)=>(0,l.jsxs)("div",{className:"flex h-8 items-center gap-2",children:[(0,l.jsx)("div",{className:"h-4 w-4 animate-pulse rounded-full bg-gray-200"}),(0,l.jsx)("div",{className:"h-4 flex-1 animate-pulse rounded bg-gray-200"})]},t))}):(0,l.jsxs)(l.Fragment,{children:[c.map(e=>(0,l.jsxs)("div",{className:"flex h-8 cursor-pointer items-center gap-2",onClick:()=>u(e),children:[(0,l.jsx)("div",{className:(0,b.cn)("hover:bg-brand/10 flex h-4 w-4 items-center justify-center rounded-full border border-solid border-black/12 p-[1px] transition-colors",(null==d?void 0:d.reason)===e.reason&&"border-brand"),children:(0,l.jsx)("div",{className:(0,b.cn)("h-1.5 w-1.5 rounded-full bg-transparent",(null==d?void 0:d.reason)===e.reason&&"bg-brand")})}),(0,l.jsx)("div",{className:"flex-1 pt-0.5 text-[14px] text-black/95",children:e.description})]},e.reason)),(null==d?void 0:d.reason)==="other"&&(0,l.jsx)("input",{type:"text",className:"h-8 rounded-[10px] border border-solid border-black/12 px-2 text-[14px] text-black/95 placeholder:text-black/30",value:p,onChange:e=>m(e.target.value),placeholder:"Enter reason"})]})}),(0,l.jsxs)("div",{className:"mt-3 flex items-center justify-end gap-2",children:[(0,l.jsx)("button",{className:"h-9 w-[75px] cursor-pointer rounded-[10px] border border-solid border-black/12 text-[14px] text-black/95 hover:bg-black/6",onClick:n,disabled:g,children:"Cancel"}),(0,l.jsx)("button",{className:(0,b.cn)("bg-brand flex h-9 w-[134px] cursor-pointer items-center justify-center rounded-[10px] text-[14px] text-white disabled:opacity-50",S&&"hover:bg-brand/85"),onClick:()=>{d&&N({reason:d.reason,details:"other"===d.reason?p:void 0})},disabled:!S,children:g?(0,l.jsx)(a.rbo,{className:"h-4 w-4 animate-spin"}):"Submit Report"})]})]})})};var w=r(565),_=r(9962),y=r(17928),k=r(53030),N=r(60750);r(90239);var S=r(17023),C=r(1021),R=r(70165),E=r(80191),T=r(4821),P=r(66139),L=r(61884);let A=e=>{let{project:t,onCommentClick:r,isSelected:n=!1}=e,{track:o}=(0,h.s)(),c=(0,s.useCallback)(()=>{r()},[t.project_url,r]);return(0,l.jsxs)("button",{className:(0,b.cn)("flex h-8 cursor-pointer items-center justify-center gap-1 rounded-[10px] px-2 hover:bg-black/6",n?"bg-black/6":"bg-black/3"),onClick:e=>{e.stopPropagation(),e.preventDefault(),c()},children:[(0,l.jsx)(a.Z0O,{className:"h-[14px] w-[14px] text-black/95"}),(0,l.jsx)("span",{className:"text-sm font-normal text-black/95",children:(0,L.Z)(t.comment_count||0)})]})};var F=r(66766),M=r(68236);function D(e){var t;let{project:r,onEmojiClick:a}=e,n=(0,s.useMemo)(()=>{var e,t;return null!==(t=null===(e=r.interaction)||void 0===e?void 0:e.count.reduce((e,t)=>e+t.count,0))&&void 0!==t?t:0},[r.interaction]),{emojis:o}=(0,N.k)(),c=e=>{var t,l;return(null===(l=r.interaction)||void 0===l?void 0:null===(t=l.status.find(t=>t.interaction_type===e))||void 0===t?void 0:t.status)===!0};return(0,l.jsxs)(k.rI,{triggerType:"hover",children:[(0,l.jsx)(k.ty,{children:(0,l.jsxs)("button",{className:"flex h-8 cursor-pointer items-center justify-center gap-1 rounded-[10px] bg-black/[0.03] px-2 py-2.5 hover:bg-black/6",children:[(0,l.jsx)(F.default,{src:M.A,alt:"emoji reaction count",className:"h-3.5 w-6"}),(0,l.jsx)("span",{className:"text-sm leading-[1.2] text-black/95",children:(0,L.Z)(n)})]})}),(0,l.jsx)(k.SQ,{className:"bottom-10 left-1/2 w-20 -translate-x-1/2 p-1",children:(0,l.jsx)("div",{className:"flex flex-col gap-1",children:null===(t=r.interaction)||void 0===t?void 0:t.count.map(e=>{let t=o.find(t=>t.interaction_type===e.interaction_type);return t?(0,l.jsxs)("div",{className:(0,b.cn)("flex h-8 cursor-pointer items-center gap-1 rounded-[8px] px-2 py-1.5 transition-colors",c(e.interaction_type)?"bg-lime-700/10":"bg-white/3 hover:bg-black/6"),onClick:t=>{t.stopPropagation(),t.preventDefault(),null==a||a(e.interaction_type)},children:[(0,l.jsx)(S.m,{emoji:t,className:"h-5 w-5 flex-shrink-0",width:20,height:20,triggerType:S.Z.Click,selected:c(e.interaction_type)}),(0,l.jsx)("span",{className:"text-sm font-normal text-black/95",children:(0,L.Z)(e.count)})]},e.interaction_type):null})})})]})}var I=r(6874),U=r.n(I),z=r(21620);let O=z.bL,H=z.l9;z.Mz,z.ZL;let Z=s.forwardRef((e,t)=>{let{className:r,align:a="center",sideOffset:n=4,showArrow:s=!1,...o}=e;return(0,l.jsx)(z.ZL,{children:(0,l.jsxs)(z.UC,{ref:t,align:a,sideOffset:n,className:(0,b.cn)("z-50",r),...o,children:[o.children,s&&(0,l.jsx)(z.i3,{className:"fill-popover -my-px drop-shadow-[0_1px_0_hsl(var(--border))]"})]})})});Z.displayName=z.UC.displayName;var W=r(80878),Y=r(10862),K=r(89003);let q=()=>{try{let e=localStorage.getItem(R.Hx);return e?JSON.parse(e):[]}catch(e){return[]}},B=e=>{try{let t=q();t.includes(e)||(t.push(e),localStorage.setItem(R.Hx,JSON.stringify(t)))}catch(e){}},J=e=>{var t,r;let{project:n}=e,[o,c]=(0,s.useState)((null===(t=n.community_info)||void 0===t?void 0:t.is_favorited)||!1),[i,d]=(0,s.useState)((null===(r=n.community_info)||void 0===r?void 0:r.favorite_count)||0),[u,p]=(0,s.useState)(!1),m=(0,s.useRef)(null),{user:x}=(0,Y.A)(),{checkAuth:f}=(0,K.M)(),{track:b}=(0,h.s)();(0,s.useEffect)(()=>()=>{m.current&&clearTimeout(m.current)},[]),(0,s.useEffect)(()=>{if(!u)return;let e=()=>{setTimeout(()=>{let e=document.activeElement;e&&"IFRAME"===e.tagName&&(p(!1),m.current&&(clearTimeout(m.current),m.current=null))},100)},t=()=>{p(!1),m.current&&(clearTimeout(m.current),m.current=null)};window.addEventListener("blur",e);let r=document.querySelectorAll("iframe");return r.forEach(e=>{e.addEventListener("focus",t)}),()=>{window.removeEventListener("blur",e),r.forEach(e=>{e.removeEventListener("focus",t)})}},[u]);let j=(0,s.useCallback)(e=>{p(e),!e&&m.current&&(clearTimeout(m.current),m.current=null)},[]),g=(0,s.useCallback)(async()=>{let e=!o,t=e?i+1:i-1;return b("app_page_save_button_click",{action:o?"false":"true",project_id:n.project_id,project_url:n.project_url,location:"app_page",count:t}),f(async()=>{c(e),d(t);let r=o?"cancel":"add";"add"===r&&x&&(p(!0),m.current&&clearTimeout(m.current),m.current=setTimeout(()=>{p(!1),m.current=null},4e3));try{var l;let e=await (0,W.s)(n.project_id,r);(null===(l=e.data)||void 0===l?void 0:l.status)&&x&&"add"===r&&B(x.uid)}catch(t){console.error("Failed to favorite project:",t),c(o),d(i),p(!1),m.current&&(clearTimeout(m.current),m.current=null),(0,v.P)({message:e?"Couldn't save project. Please check your network and try again.":"Couldn't unsave project. Please check your network and try again.",type:"error"})}},{title:"Want to save this project?",description:"Log in to save it and come back anytime.",cancelText:"Cancel",confirmText:"Log in"})()},[x,o,i,n.project_id,n.project_url,b]);return(0,l.jsxs)(O,{open:u,onOpenChange:j,children:[(0,l.jsx)(H,{asChild:!0,children:(0,l.jsxs)("button",{className:"flex h-8 cursor-pointer items-center justify-center gap-1 rounded-[10px] bg-black/3 px-2 hover:bg-black/6",onClick:e=>{e.stopPropagation(),e.preventDefault(),g()},children:[o?(0,l.jsx)(a.H9m,{className:"h-[14px] w-[14px]",style:{color:"rgba(255, 201, 55, 0.95)"}}):(0,l.jsx)(a.YSf,{className:"h-[14px] w-[14px] text-black/95"}),(0,l.jsx)("span",{className:"text-sm font-normal text-black/95",children:(0,L.Z)(i)})]})}),(0,l.jsx)(Z,{className:"w-auto translate-x-[-40px] rounded-[10px] p-0 shadow-[0px_16px_48px_1px_rgba(12,12,13,0.1)]",side:"top",align:"center",sideOffset:16,children:(0,l.jsxs)("div",{className:"flex items-center justify-center gap-1 rounded-[10px] bg-white py-1 pr-1 pl-3",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"flex h-4 w-4 items-center justify-center",children:(0,l.jsx)(a.Jnp,{className:"h-[14.6px] w-[14.6px] text-[#14AE5C]"})}),(0,l.jsx)("span",{className:"text-[14px] leading-[15.68px] font-normal tracking-[-0.03em] text-black/95",children:"Saved successfully！"})]}),(0,l.jsx)("div",{className:"h-4 w-px bg-black/6"}),(0,l.jsx)(U(),{href:"/profile/".concat(null==x?void 0:x.uid,"?tab=saved"),target:"_blank",className:"flex h-8 items-center justify-center rounded-lg px-2 text-[14px] font-bold text-black/95",children:"View list"})]})})]})};function $(e){var t;let{project:r,handleFullScreen:o,handleReport:c,onUpdate:i,onRoll:d,rolling:u,onShareClick:p,onCommentClick:m,isCommentPanelOpen:x=!1}=e,{emojis:f,registerInteractionCallback:v,interact:j}=(0,N.k)(),[g,w]=(0,s.useState)(null),[_,S]=(0,s.useState)(!1),{track:F}=(0,h.s)(),M=(0,n.useRouter)(),{remixAction:I,isRemixing:U}=(0,E.N)(),z=(null===(t=r.user)||void 0===t?void 0:t.uid)===R.v1,O=e=>{if(x)return e.preventDefault(),e.stopPropagation(),!1};(0,s.useEffect)(()=>{M.prefetch((0,P.$)())},[]),(0,s.useEffect)(()=>{v(r.project_id,(e,t)=>{i(r,t)})},[r.project_id,v]),(0,s.useEffect)(()=>{_&&w(window.innerWidth<=640)},[_]),(0,s.useEffect)(()=>{S(!0)},[]);let H=e=>{var t,l,a,n;let s=null===(l=r.interaction)||void 0===l?void 0:null===(t=l.status.find(t=>t.interaction_type===e))||void 0===t?void 0:t.status;j(r,e,s?y.f.Cancel:y.f.Add),F("emoji_reaction_click",{action:s?"false":"true",project_id:r.project_id,project_url:r.project_url,emoji:e,location:"app_page",count:((null===(n=r.interaction)||void 0===n?void 0:null===(a=n.count.find(t=>t.interaction_type===e))||void 0===a?void 0:a.count)||0)+(s?-1:1)})},Z=(0,s.useCallback)(async()=>{if(!r.allow_remix){(0,T.S)({title:"Remix Not Supported",description:"This project doesn't allow remixing",confirmText:"Got it",onConfirm:()=>{}});return}F("remix_button_click",{origin_project_id:r.project_id,origin_project_url:r.project_url,remix_count:r.remix_count,location:"app_page",access_control:r.allow_remix?"allowed":"not_allowed"}),await I(r.project_id,"remix")},[I]),W=()=>(0,l.jsx)("button",{className:(0,b.cn)("flex h-8 w-8 cursor-pointer items-center justify-center rounded-[10px] bg-black/[0.03] hover:bg-black/6",x&&"pointer-events-none cursor-not-allowed opacity-50"),onClick:e=>{if(x){O(e);return}p()},children:(0,l.jsx)(a.d6X,{className:"h-[14px] w-[14px] text-black/95"})}),Y=()=>(0,l.jsx)("div",{className:"h-[16px] w-[1px] bg-black/6"});return _&&null!==g?(0,l.jsxs)("div",{className:(0,b.cn)("bg-body flex h-12 w-full max-w-full flex-row items-center justify-between gap-4 overflow-visible px-4",g&&"h-[72px] border-t border-black/6"),children:[(0,l.jsxs)("div",{id:"left-container",className:"flex flex-1 shrink-0 flex-row items-center gap-2",children:[(0,l.jsxs)("a",{id:"logo-container",className:(0,b.cn)("flex cursor-pointer flex-row items-center gap-1",x&&"pointer-events-none cursor-not-allowed opacity-50"),onClick:e=>{if(x){O(e);return}F("app_watermark_button_click",{project_id:r.project_id,project_url:r.project_url}),M.push((0,P.$)())},children:[(0,l.jsx)("img",{src:"/icons/logo.svg",alt:"Logo",className:"text-brand h-6 w-6"}),(0,l.jsx)("div",{className:"hidden text-base leading-5 text-black/95 sm:block",children:"YouWare"})]}),!z&&Y(),!z&&(()=>{var e,t;let a=(0,P.$)();return(0,l.jsxs)("div",{id:"user-container",className:(0,b.cn)("flex cursor-pointer flex-row items-center gap-2",x&&"pointer-events-none cursor-not-allowed opacity-50"),onClick:e=>{var t;if(x){O(e);return}M.push("".concat(a,"/profile/").concat(null===(t=r.user)||void 0===t?void 0:t.uid)),F("app_creator_info_click",{project_id:r.project_id,project_url:r.project_url})},children:[(0,l.jsx)("img",{src:(null===(e=r.user)||void 0===e?void 0:e.photo_url)||"/images/avatar.svg",alt:"",className:"h-5 w-5 rounded-full bg-gray-200 object-cover"}),!g&&(0,l.jsx)("div",{className:"hidden text-sm font-medium text-black/95 sm:block",children:null===(t=r.user)||void 0===t?void 0:t.display_name})]})})()]}),(0,l.jsx)("div",{className:(0,b.cn)("hover:bg-brand border-brand text-brand absolute left-1/2 z-10 flex h-[36px] w-[86px] -translate-x-1/2 transform cursor-pointer items-center justify-center rounded-[12px] border hover:text-white",u&&"bg-brand text-white",g&&"bg-brand h-[48px] w-[96px] rounded-[16px] border-none text-white shadow-[0px_8px_20px_0px_rgba(55,67,45,0.30)] active:bg-[#44503B] active:shadow-none",x&&"pointer-events-none cursor-not-allowed opacity-50"),onClick:e=>{if(x){O(e);return}d(r)},children:(0,l.jsx)("div",{className:"flex items-center gap-1",children:u?(0,l.jsx)(C.A,{style:{width:g?"28px":"20px",height:g?"28px":"20px"},animationPath:"/animations/lottie-roll-project.json"}):(0,l.jsx)(a.OB8,{className:(0,b.cn)("h-5 w-5",g&&"h-[28px] w-[28px]")})})}),(0,l.jsxs)("div",{className:"flex min-w-0 flex-1 items-center justify-end gap-2",children:[!z&&g&&(0,l.jsxs)("div",{className:"ml-auto flex shrink-0 items-center gap-2",children:[(0,l.jsx)(A,{project:r,onCommentClick:m,isSelected:x}),W()]}),!g&&(0,l.jsxs)("div",{className:"flex shrink-0 items-center gap-2",children:[(0,l.jsxs)("div",{className:"flex h-8 items-center justify-center gap-1 rounded-[10px]",children:[(0,l.jsx)(a.tLq,{className:"h-[14px] w-[14px] text-black/95"}),(0,l.jsx)("span",{className:"text-sm font-normal text-black/95",children:(0,L.Z)(r.view_count||0)})]}),Y(),!z&&(0,l.jsx)("div",{className:(0,b.cn)("relative",x&&"pointer-events-none opacity-50"),onClick:O,children:(0,l.jsx)(D,{project:r,onEmojiClick:e=>{H(e)}})}),(0,l.jsx)("div",{className:(0,b.cn)("relative",x&&"pointer-events-none opacity-50"),onClick:O,children:(0,l.jsx)(J,{project:r},r.project_id)}),(0,l.jsx)(A,{project:r,onCommentClick:m,isSelected:x}),W(),(0,l.jsx)("div",{className:(0,b.cn)("relative",x&&"pointer-events-none opacity-50"),children:(0,l.jsxs)(k.rI,{triggerType:"hover",children:[(0,l.jsx)(k.ty,{className:"flex h-8 w-8 cursor-pointer items-center justify-center rounded-[10px] bg-black/3 hover:bg-black/6",children:(0,l.jsx)(a.aWm,{className:"h-[14px] w-[14px]",color:"black"})}),(0,l.jsxs)(k.SQ,{className:"right-0 bottom-10 w-[148px]",children:[(0,l.jsx)(k._2,{icon:a.nHt,label:"Full Screen",onClick:o}),!z&&(0,l.jsx)(k._2,{disabled:U||!r.allow_remix,icon:U?a.xNY:a.xP3,label:"Remix",onClick:Z}),(0,l.jsx)(k._2,{icon:a.qGO,label:"Report",onClick:c})]})]})})]})]})]}):(0,l.jsx)("div",{className:(0,b.cn)("flex h-12 w-full max-w-full flex-row items-center justify-between gap-4 px-4",g&&"px-6")})}let V=(0,o.createServerReference)("405013438e102f19575870024c7002b7f73104aff3",o.callServer,void 0,o.findSourceMapURL,"createComment"),G=(0,o.createServerReference)("40475d54df6e479bb0cd716288cc01cf7330e46628",o.callServer,void 0,o.findSourceMapURL,"deleteComment"),Q=e=>{(0,T.S)({title:e.title,description:null==e?void 0:e.description,confirmText:"Log in",cancelText:"Cancel",onConfirm:()=>{let e=(0,P.$)(!0),t=window.location.pathname+window.location.search;window.location.href="".concat(e,"/login?returnTo=").concat(encodeURIComponent(t))},onCancel:()=>{}})},X=()=>{let{user:e}=(0,Y.A)();return{requireAuth:t=>e?(t.callback(),!0):(Q({title:t.title,description:t.description}),!1)}};var ee=r(62128);function et(e){let{onSubmit:t,allowShiftEnter:r=!1}=e,[l,a]=(0,s.useState)(""),[n,o]=(0,s.useState)(0),[c,i]=(0,s.useState)(!1),[d,u]=(0,s.useState)(""),{requireAuth:p}=X(),m=e=>{let t=0;for(let r=0;r<e.length;r++){let l=e.charCodeAt(r);l>=19968&&l<=40959||l>=12352&&l<=12447||l>=12448&&l<=12543||l>=44032&&l<=55215||l>=126976&&l<=129535?t+=2:t+=1}return t},x=async()=>{if(l.trim()&&!(n>5e3)&&!c){i(!0);try{await t(l),a(""),o(0),u("")}catch(e){(0,v.P)({message:e.message||"Failed to post comment. Please try again.",type:"error"})}finally{i(!1)}}};return{content:l,charCount:n,isSubmitting:c,errorMessage:d,MAX_CHAR_COUNT:5e3,handleChange:e=>{p({title:"Want to leave a comment?",description:"Log in to join the conversation and share your thoughts.",callback:()=>{let t=e.target.value,r=m(t);r<=5e3?(a(t),o(r),u("")):u("Character limit exceeded. Maximum ".concat(5e3," characters allowed."))}})},handleSubmit:x,handleKeyDown:e=>{"Enter"===e.key&&!e.nativeEvent.isComposing&&(!r||!e.metaKey&&!e.shiftKey)&&(e.preventDefault(),x())},resetForm:()=>{a(""),o(0),u("")}}}function er(e){let{project:t,onSubmit:r,replyTo:n,shouldFocus:o,onFocused:c,onCancelReply:i,onCancelReplyComment:d}=e,u=(0,s.useRef)(null),{content:p,charCount:m,isSubmitting:x,errorMessage:f,MAX_CHAR_COUNT:h,handleChange:v,handleSubmit:j,handleKeyDown:g,resetForm:w}=et({onSubmit:r,allowShiftEnter:!0});return(0,s.useEffect)(()=>{if(u.current){let e=u.current;e.style.overflowY="hidden",e.style.height="auto";let t=Math.min(e.scrollHeight,104);e.style.height="".concat(t,"px"),e.scrollHeight>104&&(e.style.overflowY="auto")}},[p]),(0,s.useEffect)(()=>{o&&u.current&&(u.current.focus(),null==c||c())},[o,c]),(0,l.jsxs)("div",{className:(0,b.cn)("flex flex-col p-4",n&&"border-t border-black/6"),children:[n&&(0,l.jsxs)("div",{className:"mb-3 flex items-start justify-between gap-2 pr-0 pl-2",children:[(0,l.jsxs)("div",{className:"flex flex-col items-start gap-0.5",children:[(0,l.jsxs)("span",{className:"text-xs text-black/30",children:["Reply to ",n.user.display_name,":"]}),(0,l.jsx)("span",{className:"text-sm text-black/65",children:n.comment})]}),(0,l.jsx)("button",{className:"h-6 w-6 text-xs text-black/95",onClick:()=>null==d?void 0:d(),children:(0,l.jsx)(a.Qks,{className:"h-4 w-4"})})]}),(0,l.jsx)("textarea",{id:"comment-input",ref:u,className:"max-h-[104px] w-full resize-none rounded-[10px] border border-black/6 bg-white px-3 py-[10px] text-sm outline-none focus:border-black/65",placeholder:n?"":"Join the conversation",value:p,onChange:v,onKeyDown:g,rows:1}),f&&(0,l.jsx)("p",{className:"mt-2 w-full overflow-hidden text-xs break-words text-[#D42727]",children:f}),(0,l.jsxs)("div",{className:"mt-3 flex justify-end gap-3",children:[(0,l.jsx)("button",{className:"h-8 w-17 cursor-pointer rounded-[10px] border border-black/3 px-[10px] text-sm hover:border-transparent hover:bg-black/3 disabled:cursor-not-allowed",onClick:i||w,disabled:x,children:"Cancel"}),(0,l.jsxs)("button",{className:(0,b.cn)("bg-brand flex h-8 cursor-pointer items-center gap-2 rounded-[10px] px-[10px] text-sm text-white",(!p.trim()||m>h||x)&&"cursor-not-allowed opacity-30"),onClick:j,disabled:!p.trim()||m>h||x,children:[x&&(0,l.jsx)(a.xNY,{className:"h-4 w-4 animate-spin"}),"Comment"]})]})]})}let el=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Math.floor(Date.now()/1e3),r=t-e;return r<60?"".concat(r,"s ago"):r<3600?"".concat(Math.floor(r/60),"m ago"):r<86400?"".concat(Math.floor(r/3600),"h ago"):"".concat(Math.floor(r/86400),"d ago")},ea=e=>{let t=/(https?:\/\/[^\s]+)/g;return e.split(t).map((e,r)=>t.test(e)?(0,l.jsx)("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"pointer-events-auto cursor-pointer break-all text-[#0077FF] hover:underline",children:e},r):e)};function en(e){var t,r;let{comment:n,currentUserId:o,projectAuthorId:c,onReply:i,onDelete:d,isHighlighted:u=!1}=e,p=n.user.uid===o,m=n.user.uid===c,x=(0,s.useRef)(null),f=(0,s.useMemo)(()=>el(n.create_time),[n.create_time]);return(0,l.jsx)("div",{ref:x,className:(0,b.cn)("rounded-xl p-2",u&&"bg-[#5581340F]"),children:(0,l.jsxs)("div",{className:"flex items-start gap-3",children:[(0,l.jsxs)("div",{className:"group relative mt-0.5 h-[30px] w-[30px] shrink-0 cursor-pointer rounded-full",onClick:()=>window.open("/profile/".concat(n.user.uid),"_blank"),children:[(0,l.jsx)("img",{src:n.user.photo_url||"/images/avatar.svg",alt:"",className:"h-full w-full rounded-full"}),(0,l.jsx)("div",{className:"absolute inset-0 rounded-full bg-black/6 opacity-0 transition-opacity duration-200 group-hover:opacity-100"})]}),(0,l.jsxs)("div",{className:"flex flex-1 flex-col",children:[(0,l.jsxs)("div",{className:"flex items-center justify-start gap-1",children:[(0,l.jsx)("span",{className:"w-fit cursor-pointer text-xs text-black/65 hover:text-black/95",onClick:()=>window.open("/profile/".concat(n.user.uid),"_blank"),children:n.user.display_name}),(null===(t=n.user.badge)||void 0===t?void 0:t.value)&&(0,l.jsx)("span",{className:"h-4 rounded-full bg-[#C7AB73] px-[5px] text-[10px] leading-[16px] text-white",children:null===(r=n.user.badge)||void 0===r?void 0:r.value}),m&&(0,l.jsx)("span",{className:"h-4 rounded-full bg-[#55644A1A] px-[5px] text-[10px] leading-[16px] text-[#55644A]",children:"Creator"})]}),(0,l.jsxs)("div",{className:"mt-[2px] text-sm break-words text-black/95",children:[n.reply_user&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:"text-black/65",children:"Reply to "}),(0,l.jsx)("button",{className:"cursor-pointer font-bold text-black/95 hover:underline",onClick:()=>window.open("/profile/".concat(n.reply_user.uid),"_blank"),children:n.reply_user.display_name}),(0,l.jsx)("span",{className:"text-black/65",children:": "})]}),(0,l.jsx)("div",{className:(0,b.cn)("w-full max-w-none overflow-hidden text-sm whitespace-pre-line",n.reply_user&&"inline"),children:ea(n.comment)})]}),(0,l.jsxs)("div",{className:"mt-[7.5px] flex items-center gap-2 text-xs text-black/30",children:[(0,l.jsx)("span",{children:f}),(0,l.jsx)("div",{className:"h-2 w-px bg-black/6"}),(0,l.jsx)("span",{className:"cursor-pointer rounded-lg px-1.5 py-1 text-black/65 hover:bg-black/3",onClick:()=>i(n),children:"Reply"})]})]}),p&&(0,l.jsxs)(k.rI,{triggerType:"click",children:[(0,l.jsx)(k.ty,{children:(0,l.jsx)("div",{className:"flex h-6 w-6 items-center justify-center rounded-lg hover:bg-black/3",children:(0,l.jsx)(a.BlR,{className:"h-4 w-4 cursor-pointer text-black/95"})})}),(0,l.jsx)(k.SQ,{className:(0,b.cn)("top-8 right-0 w-28"),children:(0,l.jsx)(k._2,{icon:a.WFf,label:"Delete",onClick:()=>d(n)})})]})]})})}function es(e){var t;let{project:r}=e,n=(null===(t=r.user)||void 0===t?void 0:t.uid)===R.v1,{interact:s}=(0,N.k)(),{track:o}=(0,h.s)(),c=e=>{var t,l,a,n;let c=null===(l=r.interaction)||void 0===l?void 0:null===(t=l.status.find(t=>t.interaction_type===e))||void 0===t?void 0:t.status;s(r,e,c?y.f.Cancel:y.f.Add),o("emoji_reaction_click",{action:c?"false":"true",project_id:r.project_id,project_url:r.project_url,emoji:e,location:"app_page",count:((null===(n=r.interaction)||void 0===n?void 0:null===(a=n.count.find(t=>t.interaction_type===e))||void 0===a?void 0:a.count)||0)+(c?-1:1)})};return(0,l.jsx)("div",{className:"flex flex-col border-t border-black/6 p-4",children:(0,l.jsxs)("div",{className:"flex w-full items-center justify-between gap-2",children:[(0,l.jsxs)("div",{className:"flex h-8 items-center justify-center gap-1 rounded-[10px]",children:[(0,l.jsx)(a.tLq,{className:"h-[14px] w-[14px] text-black/95"}),(0,l.jsx)("span",{className:"text-sm font-normal text-black/95",children:(0,L.Z)(r.view_count||0)})]}),(0,l.jsxs)("div",{className:"flex h-8 items-center justify-center gap-2",children:[!n&&(0,l.jsx)(D,{project:r,onEmojiClick:e=>{c(e)}}),(0,l.jsx)(J,{project:r})]})]})})}var eo=r(47650);function ec(e){let{project:t,onSubmit:r,replyTo:n,onCancel:o}=e,[c,i]=(0,s.useState)(!1),d=(0,s.useRef)(null),{content:u,charCount:p,isSubmitting:m,errorMessage:x,MAX_CHAR_COUNT:f,handleChange:h,handleSubmit:v,handleKeyDown:j,resetForm:g}=et({onSubmit:r,allowShiftEnter:!1});if((0,s.useEffect)(()=>{i(!0)},[]),(0,s.useEffect)(()=>{d.current&&(d.current.style.height="auto",d.current.style.height="".concat(d.current.scrollHeight,"px"))},[u]),!c)return null;let w=(0,l.jsx)("div",{className:"fixed inset-0 z-[50] flex items-center justify-center bg-black/20 px-4 sm:hidden",onClick:e=>{e.target===e.currentTarget&&o&&o()},children:(0,l.jsxs)("div",{className:"flex w-full max-w-md flex-col overflow-hidden rounded-2xl bg-white p-4 shadow-[0px_16px_48px_1px_rgba(0,0,0,0.2)]",children:[n&&(0,l.jsx)("div",{className:"mb-3 flex w-full items-start justify-between gap-2 pr-0 pl-2",children:(0,l.jsxs)("div",{className:"flex flex-col items-start gap-0.5",children:[(0,l.jsxs)("span",{className:"text-xs text-black/30",children:["Reply to ",n.user.display_name,":"]}),(0,l.jsx)("span",{className:"text-sm text-black/65",children:n.comment})]})}),(0,l.jsx)("textarea",{id:"comment-input",ref:d,className:"max-h-[104px] w-full resize-none rounded-[10px] border border-black/6 bg-white px-3 py-[10px] text-sm outline-none focus:border-black/65",value:u,onChange:h,onKeyDown:j,autoFocus:!0,rows:1}),x&&(0,l.jsx)("p",{className:"mt-2 w-full overflow-hidden text-xs break-words text-[#D42727]",children:x}),(0,l.jsxs)("div",{className:"mt-3 flex w-full justify-end gap-3",children:[(0,l.jsx)("button",{className:"h-8 w-17 cursor-pointer rounded-[10px] border border-black/3 px-[10px] text-sm hover:border-transparent hover:bg-black/3 disabled:cursor-not-allowed",onClick:o||g,disabled:m,children:"Cancel"}),(0,l.jsxs)("button",{className:(0,b.cn)("bg-brand flex h-8 cursor-pointer items-center gap-2 rounded-[10px] px-[10px] text-sm text-white",(!u.trim()||p>f||m)&&"cursor-not-allowed opacity-30"),onClick:v,disabled:!u.trim()||p>f||m,children:[m&&(0,l.jsx)(a.xNY,{className:"h-4 w-4 animate-spin"}),"Comment"]})]})]})});return(0,eo.createPortal)(w,document.body)}function ei(e){let{project:t,onSubmit:r,replyTo:a,onCancelReply:n}=e,o=(0,s.useRef)(null),{user:c}=(0,Y.A)(),{content:i,handleChange:d,handleKeyDown:u}=et({onSubmit:r,allowShiftEnter:!1});return(0,l.jsxs)("div",{className:"flex flex-col p-4",children:[(0,l.jsxs)("div",{className:"flex w-full items-center justify-between gap-3",children:[(0,l.jsx)("div",{className:"mt-0.5 h-[30px] w-[30px] cursor-pointer rounded-full bg-cover bg-center",style:{backgroundImage:"url(".concat((null==c?void 0:c.photo_url)||"/images/avatar.svg","), url('/images/avatar.svg')")},onClick:()=>window.open("/profile/".concat(null==c?void 0:c.uid),"_blank")}),(0,l.jsx)("textarea",{id:"comment-input",ref:o,className:"flex-1 resize-none rounded-[10px] border border-black/6 bg-white px-3 py-[10px] text-sm outline-none focus:border-black/20",placeholder:"Add comment...",value:i,onChange:d,onKeyDown:u,rows:1,enterKeyHint:"send"})]}),a&&(0,l.jsx)(ec,{project:t,onSubmit:r,replyTo:a,onCancel:()=>{null==n||n()}})]})}function ed(e){let{project:t,isOpen:r,onClose:n,anchorCommentId:o,onCommentCountChange:c}=e,[d,u]=(0,s.useState)([]),[p,m]=(0,s.useState)(!0),[x,f]=(0,s.useState)(!1),[v,j]=(0,s.useState)(!1),[g,w]=(0,s.useState)(void 0),[_,y]=(0,s.useState)(null),[k,N]=(0,s.useState)(t.comment_count||0),[S,C]=(0,s.useState)(o||""),[R,E]=(0,s.useState)([]),[P,L]=(0,s.useState)(null),[A,F]=(0,s.useState)(!1),{user:M}=(0,Y.A)(),{track:D}=(0,h.s)(),{requireAuth:I}=X(),U=(0,s.useRef)(null),z=(0,s.useRef)(null),O=(0,s.useRef)(null),H=(0,s.useRef)(null);(0,s.useEffect)(()=>(r&&(K(),document.body.style.overflow="hidden",D("app_comment_panel_show",{project_id:t.project_id,project_url:t.project_url,comments_num:k})),()=>{document.body.style.overflow="auto"}),[r]);let Z=e=>{let t=new Set;return e.filter(e=>!t.has(e.uuid)&&(t.add(e.uuid),!0))},W=()=>{o&&S&&(H.current&&clearTimeout(H.current),H.current=setTimeout(()=>{C("")},3e3))};(0,s.useEffect)(()=>()=>{H.current&&clearTimeout(H.current)},[]);let K=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{e||0===d.length?m(!0):f(!0);let a=await i({project_id:t.project_id,order:"asc",cursor:e?"":g||"",page_size:15,anchor_comment_id:o});if(0===a.code&&a.data){var r,l;let t=a.data.comments||[];u(r=>e?Z(t):Z([...r,...t])),null==c||c(a.data.total||0),N(a.data.total||0),L(a.data.anchor_comment||null),j((null===(r=a.data.page_info)||void 0===r?void 0:r.has_more)||!1),w(null===(l=a.data.page_info)||void 0===l?void 0:l.cursor)}}catch(e){ee.vF.error("Failed to fetch comments:",e)}finally{m(!1),f(!1),W()}};(0,s.useEffect)(()=>{if(z.current&&z.current.disconnect(),!O.current||!v||p||x)return;let e=new IntersectionObserver(e=>{e[0].isIntersecting&&!p&&!x&&v&&K()},{root:U.current,rootMargin:"300px",threshold:.2});return e.observe(O.current),z.current=e,()=>{z.current&&z.current.disconnect()}},[p,x,v]);let q=async e=>{let r=await V({project_id:t.project_id,comment_text:e,reply_comment_id:null==_?void 0:_.uuid});if(0===r.code&&r.data){let l=r.data,a=Math.max(k+1,0);E(e=>[l,...e]),null==c||c(a),N(a),y(null),D("app_comment_sent",{project_id:t.project_id,project_url:t.project_url,comments_num:a,comment_detail:e,reply_detail:null==_?void 0:_.comment}),U.current&&U.current.scrollTo({top:0,behavior:"smooth"})}else throw Error(r.message||"Failed to create comment")},B=async e=>{(0,T.S)({title:"Delete this comment?",description:"This action can't be undone.",confirmText:"Delete",cancelText:"Cancel",onCancel:()=>{},onConfirm:async()=>{try{let r=await G({project_id:t.project_id,comment_id:e.uuid});if(0===r.code){u(t=>t.filter(t=>t.uuid!==e.uuid)),E(t=>t.filter(t=>t.uuid!==e.uuid)),e.uuid===o&&L(null);let r=Math.max(k-1,0);null==c||c(r),N(r),D("app_comment_delete",{project_id:t.project_id,project_url:t.project_url,comment_detail:e.comment,comments_num:r})}}catch(e){ee.vF.error("Failed to delete comment:",e)}},confirmClassName:"bg-[#D42727]! hover:bg-[#D42727]/85!"})},J=e=>{I({title:"Want to leave a comment?",description:"Log in to join the conversation and share your thoughts.",callback:()=>{y(e),F(!0)}})};return(0,l.jsxs)(l.Fragment,{children:[r&&(0,l.jsx)("div",{className:"fixed inset-0 z-[49] bg-black/20 sm:bg-transparent",onClick:n}),(0,l.jsxs)("div",{className:(0,b.cn)("fixed z-50 flex flex-col overflow-hidden rounded-2xl bg-white shadow-[0px_16px_48px_1px_rgba(0,0,0,0.2)] transition-transform duration-300","sm:top-2 sm:right-2 sm:bottom-[48px] sm:h-[calc(100vh-48px-8px)] sm:w-[400px]","max-sm:right-0 max-sm:bottom-0 max-sm:left-0 max-sm:h-[80vh] max-sm:w-full max-sm:rounded-t-lg max-sm:rounded-b-none",r?"translate-x-0 translate-y-0":"max-sm:translate-y-full sm:translate-x-[calc(100%+8px)]"),children:[(0,l.jsx)("div",{className:"mt-2 flex items-center justify-between px-5 py-2",children:(0,l.jsx)("h3",{className:"text-base font-bold text-black/95",children:1===k?"1 Comment":"".concat(k," Comments")})}),(0,l.jsx)("div",{className:"block sm:hidden",children:(0,l.jsx)(ei,{project:t,onSubmit:q,replyTo:_,onCancelReply:()=>{y(null)}})}),(0,l.jsx)("div",{className:"hidden border-b border-black/6 sm:block"}),(0,l.jsxs)("div",{ref:U,className:"flex-1 overflow-y-auto p-2",children:[p&&0===d.length&&(0,l.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,l.jsx)("div",{className:"flex items-center space-x-2",children:(0,l.jsx)(a.xNY,{className:"h-6 w-6 animate-spin text-black/30"})})}),!p&&0===d.length&&0===R.length&&(0,l.jsxs)("div",{className:"flex h-full flex-col items-center justify-center px-[60px] text-black/65",children:[(0,l.jsx)(a.My6,{className:"mb-3 h-8 w-8 text-black/12"}),(0,l.jsx)("p",{className:"mb-1 text-sm font-bold text-black/95",children:"Be the first to comment"}),(0,l.jsx)("p",{className:"text-center text-xs text-black/65",children:"Add your voice and let the creator hear from you."})]}),(d.length>0||R.length>0||o)&&(0,l.jsxs)(l.Fragment,{children:[(()=>{let e=new Set(R.map(e=>e.uuid)),t=null==P?void 0:P.uuid,r=d.filter(r=>!e.has(r.uuid)&&r.uuid!==t);return[...[...R].sort((e,t)=>new Date(t.create_time).getTime()-new Date(e.create_time).getTime()),...P?[P]:[],...r]})().map((e,r)=>{var a;return(0,l.jsx)(en,{comment:e,currentUserId:(null==M?void 0:M.uid)||"",projectAuthorId:(null===(a=t.user)||void 0===a?void 0:a.uid)||"",onReply:J,onDelete:B,isHighlighted:e.uuid===S},r)}),v&&(0,l.jsx)("div",{ref:O,className:"flex items-center justify-center py-4",children:x&&(0,l.jsx)(a.xNY,{className:"h-6 w-6 animate-spin text-black/30"})})]})]}),(0,l.jsx)("div",{className:"hidden sm:block",children:(0,l.jsx)(er,{project:t,onSubmit:q,replyTo:_,shouldFocus:A,onFocused:()=>{F(!1)},onCancelReply:()=>{n()},onCancelReplyComment:()=>{y(null)}})}),(0,l.jsx)("div",{className:"block sm:hidden",children:(0,l.jsx)(es,{project:t})})]})]})}function eu(e){let{isPlaying:t}=e;return t?(0,l.jsx)("div",{className:"absolute inset-0 z-10 flex h-full w-full items-center justify-center bg-black",children:(0,l.jsx)(C.A,{animationPath:"/animations/lottie-roll-project-mask.json",className:"aspect-square h-[70%] items-center justify-center opacity-30",style:{pointerEvents:"none"}})}):null}var ep=r(42334),em=r(47835),ex=r(99113);function ef(e){let{subdomain:t,onVerificationSuccess:r}=e,[n,o]=(0,s.useState)(["","","",""]),[c,i]=(0,s.useState)("idle"),[d,u]=(0,s.useState)(""),{track:p}=(0,h.s)();(0,s.useEffect)(()=>{p("verify_passcode_page_show",{project_url:window.location.pathname})},[]);let m=(0,s.useRef)([]);(0,s.useEffect)(()=>{m.current[0]&&m.current[0].focus()},[]);let x=(e,t)=>{if("Backspace"===e.key&&!n[t]&&t>0){var r;null===(r=m.current[t-1])||void 0===r||r.focus()}},f=(0,ep.nF)({interval:200},(e,t)=>{let r=e.target.value.slice(-1);if(""===r||/^[0-9a-zA-Z]$/.test(r)){let e=[...n];if(e[t]=r,o(e),""!==r&&t<3){var l;null===(l=m.current[t+1])||void 0===l||l.focus()}""!==r&&3===t&&e.every(e=>""!==e)&&b(e.join(""))}}),v=e=>{e.preventDefault();let t=e.clipboardData.getData("text");if(/^[0-9a-zA-Z]+$/.test(t)){var r,l;let e=t.split(""),a=[...n];for(let t=0;t<Math.min(4,e.length);t++)a[t]=e[t];if(o(a),a.every(e=>""!==e))null===(r=m.current[3])||void 0===r||r.focus(),b(a.join(""));else{let e=a.findIndex(e=>""===e);-1!==e&&(null===(l=m.current[e])||void 0===l||l.focus())}}},b=async e=>{i("pending");try{let l=await (0,em.a)(t,e);(null==l?void 0:l.verified)&&(null==l?void 0:l.iframe_url)?(i("success"),p("verify_passcode_success",{project_url:window.location.pathname}),r(null==l?void 0:l.iframe_url)):(i("error"),u("Code mismatch - verify with the owner"))}catch(e){i("error"),u("Verification failed. Please try again.")}};return(0,l.jsxs)("div",{className:"min-h-screen",children:[(0,l.jsx)(ex.default,{}),(0,l.jsxs)("div",{className:"flex min-h-[calc(100vh-64px)] flex-col items-center justify-center pb-[15vh]",children:[(0,l.jsx)("h1",{className:"font-montserrat text-transform-capitalize mb-3 text-[40px] leading-[40px] font-medium",children:"Locked Project"}),(0,l.jsx)("p",{className:"",children:"A password is required to view this creation"}),(0,l.jsx)("div",{className:"my-12 flex justify-center space-x-4",children:n.map((e,t)=>(0,l.jsx)("input",{ref:e=>{m.current[t]=e},type:"text",inputMode:"text",autoComplete:"off",maxLength:1,value:e,onChange:e=>f(e,t),onKeyDown:e=>x(e,t),onPaste:0===t?v:void 0,className:"h-24 w-18 rounded-[20px] border-none text-center text-[40px] font-medium [box-shadow:12.171px_4.868px_65.722px_0px_rgba(0,0,0,0.09)] transition-all focus:outline-black",disabled:"pending"===c},t))}),(0,l.jsxs)("div",{className:"h-6 w-auto",children:["pending"===c&&(0,l.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,l.jsx)(a.xNY,{className:"h-6 w-6 animate-spin"}),(0,l.jsx)("p",{className:"text-center",children:"Verifying..."})]}),"success"===c&&(0,l.jsx)("p",{className:"text-center text-green-600",children:"✨ Access granted!"}),"error"===c&&(0,l.jsx)("p",{className:"text-center text-[#E60023]",children:d})]})]})]})}var eh=r(707);let ev=e=>({urlTitle:e.split("-").slice(0,-1).join("-"),urlHash:e.split("-").pop()||""}),eb=()=>{let e=window.location.pathname;return e.includes("/project/")?ev(e.split("/").pop()||"").urlTitle:""},ej=(0,o.createServerReference)("6094db7d95bc817cbd363649e3519d549850b71da8",o.callServer,void 0,o.findSourceMapURL,"getRandomSelectedProjects"),eg="viewed_projects",ew=()=>{try{let e=localStorage.getItem(eg);if(!e)return[];let t=JSON.parse(e),r=Date.now();return t.filter(e=>r-e.timestamp<36e5).map(e=>e.id)}catch(e){return console.error("Error getting viewed projects:",e),[]}},e_=e=>{if(e)try{let t=localStorage.getItem(eg),r=t?JSON.parse(t):[],l=Date.now(),a=r.filter(e=>l-e.timestamp<36e5),n=a.findIndex(t=>t.id===e);n>=0?a[n].timestamp=l:a.push({id:e,timestamp:l}),localStorage.setItem(eg,JSON.stringify(a))}catch(e){console.error("Error saving viewed project:",e)}},ey=()=>{let[e,t]=(0,s.useState)(!1),{checkAuth:r}=(0,K.M)(),l=async()=>{await r(async()=>{t(!0)},{title:"Want to report this project?",description:"Please log in to help keep the community safe.",cancelText:"Cancel",confirmText:"Log in"})()};return{showReportModal:e,setShowReportModal:t,handleReport:l}};function ek(e){let{projectViewDetail:t,urlHash:r,screenStatus:o,enterFrom:x}=e,f=(0,s.useRef)(null),[j,y]=(0,s.useState)(x),[k,N]=(0,s.useState)(t.iframe_url),[S,C]=(0,s.useState)(t.need_passcode&&!t.iframe_url),R=(0,n.useSearchParams)(),E=(0,n.useRouter)(),[T,P]=(0,s.useState)(!1),{track:L}=(0,h.s)(),{showReportModal:A,setShowReportModal:F,handleReport:M}=ey(),D=p(),{isFullScreen:I,handleFullScreen:U,disableExitFullScreen:z}=function(){let{initialState:e=!1,forceFullScreen:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[r,l]=(0,s.useState)(e);return(0,s.useEffect)(()=>{let e=e=>{"Escape"===e.key&&r&&!t&&l(!1)};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[r,t]),{isFullScreen:r,setIsFullScreen:l,handleFullScreen:()=>{t||l(!r)},disableExitFullScreen:t}}({initialState:"force_full"===o||"default_full"===o,forceFullScreen:"force_full"===o}),{rolling:O,project:H,handleRoll:Z,handleFinishRoll:W,setProject:Y}=function(e){let{initialProject:t,isLoading:r=!1,onProjectChange:l,onUrlChange:a}=e,[n,o]=(0,s.useState)(!1),[c,i]=(0,s.useState)(0),[d,u]=(0,s.useState)(t),{track:p}=(0,h.s)(),m=(0,s.useRef)(null);(0,s.useEffect)(()=>()=>{m.current&&clearTimeout(m.current)},[]);let x=async()=>{if(n||r)return;o(!0),i(Date.now()),m.current&&clearTimeout(m.current),m.current=setTimeout(()=>{console.log("roll timeout (including API and iframe load), auto stop"),o(!1)},5e3);let e=ew();p("app_page_random_button_click",{project_id:d.project_id,project_url:d.project_url});let t=await ej(e);if(!m.current){console.log("API request completed but timeout already occurred");return}if(t.data&&t.data.projects.length>0){let e=t.data.projects[0],r={...e,need_passcode:!1};u(r),l&&l(r),a&&e.iframe_url&&a(e.iframe_url),e.project_id&&e_(e.project_id)}else o(!1),m.current&&(clearTimeout(m.current),m.current=null)};return{rolling:n,project:d,handleRoll:x,handleFinishRoll:()=>{let e=Date.now()-c;if(m.current&&(clearTimeout(m.current),m.current=null),!d.project_url){o(!1),i(0);return}let t=d.project_url;e>1e3?(o(!1),window.history.pushState({},"",t)):setTimeout(()=>{o(!1),window.history.pushState({},"",t)},1e3-e),i(0)},setProject:u}}({initialProject:t,isLoading:S,onProjectChange:e=>{y("random_button")},onUrlChange:e=>{N(e)}});(0,s.useEffect)(()=>{let e=async()=>{let e=await u(r);N((null==e?void 0:e.iframe_url)||""),C(!1)};t.need_passcode&&!t.iframe_url&&e()},[t.need_passcode,t.iframe_url]),function(e){let{projectUrl:t}=e;(0,s.useEffect)(()=>{if(t&&location.pathname===t)return;let e=eb();if(!e){window.history.replaceState(null,"",t);return}(0,eh.S)(e).then(e=>{var r;(null==e?void 0:null===(r=e.data)||void 0===r?void 0:r.is_valid)?window.history.replaceState(null,"",t):window.location.href="/404"}).catch(e=>{window.history.replaceState(null,"",t)})},[])}({projectUrl:t.project_url}),(0,s.useEffect)(()=>{k&&(L("app_page_view",{project_id:(null==H?void 0:H.project_id)||t.project_id,project_url:(null==H?void 0:H.project_url)||t.project_url,enter_from:j}),(0,w.i)().then(e=>{d(t.project_id,"view",e,j)}))},[k]),(0,s.useEffect)(()=>{let e=R.get("comment_id");if(e){D.setHighlightedComment(e);let r=new URLSearchParams(R);r.delete("comment_id");let l="".concat(window.location.pathname).concat(r.toString()?"?".concat(r.toString()):"");E.replace(l),i({project_id:t.project_id,page_size:15,anchor_comment_id:e}).then(t=>{if(0===t.code&&t.data){var r;(null===(r=t.data.comments)||void 0===r?void 0:r.some(t=>t.uuid===e))||t.data.anchor_comment||(0,v.P)({message:"This comment has been deleted.",type:"info"})}})}},[R,t.project_id,E,D]);let K=(0,s.useCallback)(e=>{Y({...H,comment_count:Math.max(0,e)})},[H]);return((0,s.useEffect)(()=>{var e;(null===(e=(0,_.j)())||void 0===e?void 0:e.client_id)||c()},[]),S)?(0,l.jsxs)("div",{className:"flex min-h-screen flex-col items-center justify-center",children:[(0,l.jsx)(a.xNY,{className:"mx-auto mb-3 h-10 w-10 animate-spin text-gray-400"}),(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Loading..."})]}):t.need_passcode&&!k?(0,l.jsx)(ef,{subdomain:r,onVerificationSuccess:e=>{N(e)}}):(0,l.jsxs)("div",{className:"relative flex min-h-screen flex-col overflow-hidden",style:{minHeight:"100dvh"},children:[(0,l.jsx)("div",{className:(0,b.cn)("relative flex flex-1 overflow-hidden transition-all duration-300 sm:px-2 sm:pt-2",I?"pb-2":"pb-[72px] sm:pb-12"),children:(0,l.jsxs)("div",{className:"relative flex flex-1 overflow-hidden border-black/6 sm:rounded-2xl sm:border",children:[(0,l.jsx)(eu,{isPlaying:O}),(0,l.jsx)("iframe",{ref:f,src:k,className:"flex-1 overflow-hidden transition-all duration-300 ".concat(I?"!m-0 !rounded-none !border-none":""),loading:"eager",allowFullScreen:!0,seamless:!0,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; camera; microphone; geolocation; fullscreen; payment",sandbox:"allow-downloads allow-forms allow-modals allow-orientation-lock allow-pointer-lock allow-popups allow-popups-to-escape-sandbox allow-presentation allow-same-origin allow-scripts allow-top-navigation",onLoad:()=>{t.project_id!==H.project_id&&W()}})]})}),(0,l.jsx)("button",{onClick:U,className:"fixed right-2 bottom-2 z-50 cursor-pointer rounded-[10px] border border-black/12 bg-white p-2 transition-all duration-300 hover:bg-gray-100 ".concat(I&&!z?"translate-y-0 opacity-100":"translate-y-4 opacity-0"),children:(0,l.jsx)(a.a3o,{className:"h-4 w-4"})}),(0,l.jsx)("div",{className:"fixed bottom-0 left-0 z-50 w-full transition-all duration-300 ".concat(I?"translate-y-full":"translate-y-0"),children:(0,l.jsx)($,{project:H,rolling:O,handleFullScreen:U,handleReport:()=>{L("app_report_button_click",{project_id:H.project_id,project_url:H.project_url}),M()},onRoll:()=>{Z()},onShareClick:()=>P(!0),onUpdate:(e,r)=>{Y({...e,need_passcode:t.need_passcode,interaction:r})},onCommentClick:()=>{D.togglePanel(),L("app_page_view",{action:"comment_panel_open",project_id:t.project_id,project_url:t.project_url})},isCommentPanelOpen:D.isOpen})}),D.isOpen&&(0,l.jsx)(ed,{project:H,...D.commentPanelProps,onCommentCountChange:K}),A&&(0,l.jsx)(g,{contentId:H.project_id,subjectType:"project",onClose:()=>F(!1),trackExtra:{project_id:H.project_id,project_url:H.project_url}}),T&&(0,l.jsx)(m.A,{project:H,onClose:()=>P(!1),location:"app_page"})]})}},80191:(e,t,r)=>{"use strict";r.d(t,{V:()=>o.Vt,N:()=>x});var l=r(35695),a=r(12115),n=r(34477);let s=(0,n.createServerReference)("60d7ce557c6a2c4e3b865bc11edd5c8cc98944f0b0",n.callServer,void 0,n.findSourceMapURL,"remixProject");var o=r(70165),c=r(565),i=r(90239),d=r(66139),u=r(48436),p=r(89003);let m=e=>({remix:"Failed to remix project, please try again later",create:"Failed to create project, please try again later"})[e],x=()=>{let e=(0,l.useRouter)(),t=(0,i.I)(),{checkAuth:r}=(0,p.M)(),[n,o]=(0,a.useState)(!1);return{remixAction:(0,a.useCallback)(async(t,l)=>r(async()=>{o(!0);try{let r=await (0,c.i)(),a=await s(t,r);if(a.data){let t=(0,d.$)(),r={enter_from:l};"create"===l&&(r.createWeb="true"),e.push("".concat(t,"/editor/").concat(a.data.project_id,"?").concat(new URLSearchParams(r).toString()))}else(0,u.P)({message:m(l),type:"error"})}catch(e){console.log("error",e),(0,u.P)({message:m(l),type:"error"})}finally{o(!1)}setTimeout(()=>{o(!1)},1e3)},{title:"Want to remix this project?",description:"Log in to remix and customize it your way.",cancelText:"Cancel",confirmText:"Log in"})(),[t,e]),isRemixing:n}}},80878:(e,t,r)=>{"use strict";r.d(t,{s:()=>a});var l=r(34477);let a=(0,l.createServerReference)("605f5d9bbb721c8d73f69671ecc5ff03d281c3c2f1",l.callServer,void 0,l.findSourceMapURL,"favoriteProject")}},e=>{var t=t=>e(e.s=t);e.O(0,[8823,8888,6838,3463,770,5649,4157,5938,750,9113,7464,4850,8441,3688,7358],()=>t(23468)),_N_E=e.O()}]);